{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Donut chart with annotations for Global GHG Emissions by Sub-sector",
  "width": 400,
  "height": 400,
  "data": {
    "url": "https://raw.githubusercontent.com/AaronTjc/Data-Visualisation-2/refs/heads/main/Data/Global-GHG-Emissions-by-sector-based-on-WRI-2020%20(1).csv", 
    "format": {
      "type": "csv"
    }
  },
  "transform": [
    {
      "calculate": "datum['Share of global greenhouse gas emissions (%)']",
      "as": "Share"
    },
    {
      "filter": "datum['Sub-sector'] !== null"
    },
    {
      "calculate": "indexof(['Iron & Steel', 'Non-ferous metals', 'Chemical & petrochemical (energy)', 'Food and tobacco', 'Paper, pulp & printing', 'Machinery', 'Other industry', 'Road', 'Aviation', 'Ship', 'Rail', 'Pipeline', 'Residential', 'Commercial', 'Unallocated fuel combustion', 'Coal', 'Oil & Natural Gas', 'Energy in Agri & Fishing', 'Cement', 'Chemical & petrochemical (industrial)', 'Wastewater', 'Landfills', 'Grassland', 'Cropland', 'Forest Land', 'Crop Burning', 'Rice Cultivation', 'Agricultural Soils', 'Livestock & Manure'], datum['Sub-sector'])",
      "as": "Sub-sector-index"
    }
  ],
  "layer": [
    {
      "mark": {
        "type": "arc",
        "innerRadius": 160,
        "cornerRadius": 5,
        "stroke": "white",
        "strokeWidth": 2
      },
      "encoding": {
        "theta": {
          "field": "Share",
          "type": "quantitative"
        },
        "color": {
          "field": "Sub-sector",
          "type": "nominal",
          "legend": null,
          "sort": {"field": "Sub-sector-index", "order": "ascending"},
          "scale": {
            "domain": [
              "Iron & Steel", "Non-ferous metals", "Chemical & petrochemical (energy)", "Food and tobacco", "Paper, pulp & printing", 
              "Machinery", "Other industry", "Road", "Aviation", "Ship", "Rail", "Pipeline", "Residential", "Commercial", "Unallocated fuel combustion", 
              "Coal", "Oil & Natural Gas", "Energy in Agri & Fishing", "Cement", "Chemical & petrochemical (industrial)", 
              "Wastewater", "Landfills", "Grassland", "Cropland", "Forest Land", "Crop Burning", "Rice Cultivation", "Agricultural Soils", "Livestock & Manure"
            ],
            "range": [
              "#640b0b", "#640b0b", "#640b0b", "#640b0b", "#640b0b", 
              "#640b0b", "#640b0b", "#640b0b", "#640b0b", "#640b0b", 
              "#640b0b", "#640b0b", "#640b0b", "#640b0b", "#640b0b", 
              "#640b0b", "#640b0b", "#640b0b", "#505050", "#505050", 
              "#6B5B95", "#6B5B95", "#2E7D32", "#2E7D32", "#2E7D32", 
              "#2E7D32", "#2E7D32", "#2E7D32", "#2E7D32"
            ]
          }
        },
        "order": {
          "field": "Sub-sector-index",
          "type": "quantitative"
        },
        "tooltip": [
          {"field": "Sub-sector", "type": "nominal"},
          {"field": "Share", "type": "quantitative", "format": ".1f"}
        ]
      }
    },   
    {
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "fill": "black",
        "dx": -88,  
        "dy": -140, 
        "fontSize": 26
      },
      "encoding": {
        "x": {"value": 150},  
        "y": {"value": 320},  
        "text": {"value": "Global Greenhouse Gas"}
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "fill": "black",
        "dx": -88,  
        "dy": -140, 
        "fontSize": 26
      },
      "encoding": {
        "x": {"value": 175},  
        "y": {"value": 360},  
        "text": {"value": "Emissions by sector"}
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "fill": "grey",
        "dx": -88,  
        "dy": -140, 
        "fontSize": 12
      },
      "encoding": {
        "x": {"value": 205},  
        "y": {"value": 400},  
        "text": {"value": "(Hover over to view sub-sector)"}
      }
    },
    {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "middle",
          "fill": "#2E7D32",
          "dx": -88,  
          "dy": -140, 
          "fontSize": 20,
          "fontStyle": "italic"
        },
        "encoding": {
          "x": {"value": -35},  
          "y": {"value": 160},  
          "text": {"value": "Agriculture, Forestry"}
        }
    },
    {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "middle",
          "fill": "#2E7D32",
          "dx": -88,  
          "dy": -140, 
          "fontSize": 20,
          "fontStyle": "italic"
        },
        "encoding": {
          "x": {"value": -40},  
          "y": {"value": 180},  
          "text": {"value": "& Land Use (18.4%)"}
        }
    },
    {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "middle",
          "fill": "#640b0b",
          "dx": -88,  
          "dy": -140, 
          "fontSize": 20,
          "fontStyle": "italic"
        },
        "encoding": {
          "x": {"value": 450},  
          "y": {"value": 200},  
          "text": {"value": "Energy (73.2%)"}
        }
    },
    {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "middle",
          "fill": "#6B5B95",
          "dx": -88,  
          "dy": -140,  
          "fontSize": 20,
          "fontStyle": "italic"
        },
        "encoding": {
          "x": {"value": -35},  
          "y": {"value": 280},  
          "text": {"value": "Waste (3.2%)"}
        }
    },
    {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "middle",
          "fill": "#505050",
          "dx": -88,  
          "dy": -140,  
          "fontSize": 20,
          "fontStyle": "italic"
        },
        "encoding": {
          "x": {"value": -55},  
          "y": {"value": 330},  
          "text": {"value": "Industry (5.2%)"}
        }
    }
  ],
  "view": {"stroke": null}
}
